<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI-powered judicial decision drafting assistant">
    <meta name="theme-color" content="#3b82f6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="LexAI">
    <link rel="manifest" href="./judge.manifest.json">
    <title>LexAI Judicial Assistant</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @media print {
            body { background: white; }
            .no-print { display: none !important; }
        }
        /* Custom scrollbar for textareas */
        textarea::-webkit-scrollbar {
            width: 8px;
        }
        textarea::-webkit-scrollbar-track {
            background: #f1f5f9; 
        }
        textarea::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        textarea::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans print:bg-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Icon Components (Replaced lucide-react imports) ---
        const IconBase = ({ children, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const Book = (props) => <IconBase {...props}><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></IconBase>;
        const Gavel = (props) => <IconBase {...props}><path d="m14 13-7.5 7.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L11 10"/><path d="m16 16 6-6"/><path d="m8 8 6-6"/><path d="m9 7 8 8"/><path d="m21 11-8-8"/></IconBase>;
        const Save = (props) => <IconBase {...props}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></IconBase>;
        const Upload = (props) => <IconBase {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></IconBase>;
        const Printer = (props) => <IconBase {...props}><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect width="12" height="8" x="6" y="14"/></IconBase>;
        const AlertCircle = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></IconBase>;
        const Scale = (props) => <IconBase {...props}><path d="m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1z"/><path d="m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1z"/><path d="M7 21h10"/><path d="M12 3v18"/><path d="M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2"/></IconBase>;
        const User = (props) => <IconBase {...props}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></IconBase>;
        const FileText = (props) => <IconBase {...props}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/></IconBase>;
        const Loader2 = ({ className, ...props }) => (
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>
        );


        // Environment-provided API Key
        // NOTE: In a real deployment, ensure this key is secured or proxied.
        const apiKey = ""; 

        const App = () => {
            // --- State Management ---
            const [caseData, setCaseData] = useState({
                caseNumber: '',
                prosecutionName: '',
                defendantName: '',
                prosecutionStatement: '',
                defendantStatement: '',
            });

            const [analysis, setAnalysis] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);

            const [judgment, setJudgment] = useState({
                finalSentence: '',
                judgeNotes: '',
                judgeName: '',
                date: new Date().toISOString().split('T')[0],
            });

            const fileInputRef = useRef(null);

            // --- Handlers ---

            const handleInputChange = (e, section = 'caseData') => {
                const { name, value } = e.target;
                if (section === 'caseData') {
                setCaseData(prev => ({ ...prev, [name]: value }));
                } else {
                setJudgment(prev => ({ ...prev, [name]: value }));
                }
            };

            const toggleCaseLawRelevance = (index) => {
                if (!analysis) return;
                const newCaseLaw = [...analysis.caseLaw];
                newCaseLaw[index].relevant = !newCaseLaw[index].relevant;
                setAnalysis({ ...analysis, caseLaw: newCaseLaw });
            };

            // --- API Integration ---

            const analyzeCase = async () => {
                if (!caseData.prosecutionStatement || !caseData.defendantStatement) {
                setError("Please provide statements from both the prosecution and the defendant.");
                return;
                }

                setLoading(true);
                setError(null);

                const systemPrompt = `You are an expert legal assistant AI designed to assist judges and magistrates. 
                Your task is to analyze the provided Prosecution and Defendant statements.
                
                You must output strictly valid JSON with no markdown formatting. The JSON must contain:
                1. "facts": An array of strings summarizing pertinent facts agreed upon or clearly identified from the text.
                2. "caseLaw": An array of objects, each containing:
                - "citation": Name and year of the REAL case (e.g., 'R v Smith [2021] EWCA Crim 123').
                - "summary": A brief 1-sentence summary of the legal principle.
                - "relevant": boolean (default to true).
                3. "recommendation": A string suggesting a sentence based on sentencing guidelines (assume UK/Common Law unless context implies otherwise).
                4. "confidence": A number between 0 and 100 representing confidence in the recommendation.
                5. "reasoning": A short explanation for the confidence score.`;

                const userPrompt = `
                Case Number: ${caseData.caseNumber}
                Prosecution: ${caseData.prosecutionName}
                Defendant: ${caseData.defendantName}
                
                Prosecution Statement:
                ${caseData.prosecutionStatement}
                
                Defendant Statement:
                ${caseData.defendantStatement}
                `;

                try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                    contents: [{ parts: [{ text: userPrompt }] }],
                    systemInstruction: { parts: [{ text: systemPrompt }] },
                    generationConfig: { responseMimeType: "application/json" }
                    })
                });

                if (!response.ok) throw new Error('API request failed');

                const data = await response.json();
                const rawText = data.candidates?.[0]?.content?.parts?.[0]?.text;
                
                if (rawText) {
                    const parsed = JSON.parse(rawText);
                    // Add local UI state for relevance if not present
                    parsed.caseLaw = parsed.caseLaw.map(cl => ({ ...cl, relevant: true }));
                    setAnalysis(parsed);
                } else {
                    throw new Error("No data returned from AI");
                }
                } catch (err) {
                setError("Failed to analyze case: " + err.message);
                } finally {
                setLoading(false);
                }
            };

            // --- XML Handling ---

            const generateXML = () => {
                const xmlContent = `<?xml version="1.0" encoding="UTF-8"?>
<legalCase>
<details>
    <caseNumber>${escapeXml(caseData.caseNumber)}</caseNumber>
    <prosecutionName>${escapeXml(caseData.prosecutionName)}</prosecutionName>
    <defendantName>${escapeXml(caseData.defendantName)}</defendantName>
</details>
<statements>
    <prosecution>${escapeXml(caseData.prosecutionStatement)}</prosecution>
    <defendant>${escapeXml(caseData.defendantStatement)}</defendant>
</statements>
<analysis>
    <facts>
    ${analysis ? analysis.facts.map(f => `<fact>${escapeXml(f)}</fact>`).join('\n      ') : ''}
    </facts>
    <caseLaw>
    ${analysis ? analysis.caseLaw.map(c => `
    <case relevant="${c.relevant}">
        <citation>${escapeXml(c.citation)}</citation>
        <summary>${escapeXml(c.summary)}</summary>
    </case>`).join('') : ''}
    </caseLaw>
    <recommendation confidence="${analysis?.confidence || 0}">${escapeXml(analysis?.recommendation || '')}</recommendation>
</analysis>
<judgment>
    <finalSentence>${escapeXml(judgment.finalSentence)}</finalSentence>
    <notes>${escapeXml(judgment.judgeNotes)}</notes>
    <judge>${escapeXml(judgment.judgeName)}</judge>
    <date>${judgment.date}</date>
</judgment>
</legalCase>`;
                return xmlContent;
            };

            const escapeXml = (unsafe) => {
                return unsafe.replace(/[<>&'"]/g, function (c) {
                switch (c) {
                    case '<': return '&lt;';
                    case '>': return '&gt;';
                    case '&': return '&amp;';
                    case '\'': return '&apos;';
                    case '"': return '&quot;';
                    default: return c;
                }
                });
            };

            const handleSaveXML = () => {
                const xml = generateXML();
                const blob = new Blob([xml], { type: 'text/xml' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `case_${caseData.caseNumber || 'draft'}.xml`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };

            const handleLoadXML = (event) => {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                try {
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(e.target.result, "text/xml");

                    // Helper to safely get text content
                    const getText = (parent, tag) => parent.getElementsByTagName(tag)[0]?.textContent || '';

                    // Load Case Data
                    setCaseData({
                    caseNumber: getText(xmlDoc, 'caseNumber'),
                    prosecutionName: getText(xmlDoc, 'prosecutionName'),
                    defendantName: getText(xmlDoc, 'defendantName'),
                    prosecutionStatement: getText(xmlDoc.getElementsByTagName('statements')[0], 'prosecution'),
                    defendantStatement: getText(xmlDoc.getElementsByTagName('statements')[0], 'defendant'),
                    });

                    // Load Judgment
                    setJudgment({
                    finalSentence: getText(xmlDoc, 'finalSentence'),
                    judgeNotes: getText(xmlDoc, 'notes'),
                    judgeName: getText(xmlDoc, 'judge'),
                    date: getText(xmlDoc, 'date'),
                    });

                    // Load Analysis if present
                    const factsNodes = xmlDoc.getElementsByTagName('fact');
                    const facts = Array.from(factsNodes).map(n => n.textContent);
                    
                    const caseLawNodes = xmlDoc.getElementsByTagName('case');
                    const caseLaw = Array.from(caseLawNodes).map(n => ({
                    citation: getText(n, 'citation'),
                    summary: getText(n, 'summary'),
                    relevant: n.getAttribute('relevant') === 'true'
                    }));

                    const recNode = xmlDoc.getElementsByTagName('recommendation')[0];
                    
                    if (facts.length > 0 || caseLaw.length > 0) {
                    setAnalysis({
                        facts,
                        caseLaw,
                        recommendation: recNode?.textContent || '',
                        confidence: parseInt(recNode?.getAttribute('confidence') || '0'),
                        reasoning: 'Loaded from XML' // Metadata not typically stored but needed for UI
                    });
                    }

                } catch (err) {
                    setError("Error parsing XML file. Please ensure format is correct.");
                }
                };
                reader.readAsText(file);
                event.target.value = null; // Reset input
            };

            const getConfidenceColor = (score) => {
                if (score >= 80) return 'bg-green-100 text-green-800 border-green-500';
                if (score >= 50) return 'bg-amber-100 text-amber-800 border-amber-500';
                return 'bg-red-100 text-red-800 border-red-500';
            };

            return (
                <div className="min-h-screen bg-slate-50 text-slate-900 font-sans print:bg-white">
                {/* Header */}
                <header className="bg-slate-900 text-white p-6 shadow-md print:hidden no-print">
                    <div className="max-w-5xl mx-auto flex justify-between items-center">
                    <div className="flex items-center gap-3">
                        <Scale className="w-8 h-8 text-amber-400" />
                        <div>
                        <h1 className="text-2xl font-bold">LexAI Judicial Assistant</h1>
                        <p className="text-slate-400 text-sm">AI-Powered Case Analysis & Sentencing Support</p>
                        </div>
                    </div>
                    <div className="flex gap-2">
                        <button onClick={() => fileInputRef.current.click()} className="flex items-center gap-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded transition-colors">
                        <Upload size={18} /> Load XML
                        </button>
                        <input 
                        type="file" 
                        ref={fileInputRef} 
                        onChange={handleLoadXML} 
                        accept=".xml" 
                        className="hidden" 
                        />
                        <button onClick={handleSaveXML} className="flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 rounded transition-colors">
                        <Save size={18} /> Save XML
                        </button>
                        <button onClick={() => window.print()} className="flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-500 rounded transition-colors">
                        <Printer size={18} /> Print
                        </button>
                    </div>
                    </div>
                </header>

                {/* Print Header */}
                <div className="hidden print:block p-8 border-b-2 border-black mb-8">
                    <h1 className="text-4xl font-serif font-bold text-center mb-2">OFFICIAL RECORD OF PROCEEDINGS</h1>
                    <div className="flex justify-between mt-6 text-sm">
                    <span>Printed on: {new Date().toLocaleDateString()}</span>
                    <span>Confidential Document</span>
                    </div>
                </div>

                <main className="max-w-5xl mx-auto p-6 space-y-8 print:p-0">

                    {/* Case Details */}
                    <section className="bg-white p-6 rounded-lg shadow-sm border border-slate-200 print:shadow-none print:border-none">
                    <h2 className="text-xl font-semibold mb-4 flex items-center gap-2 border-b pb-2 text-slate-700">
                        <FileText className="w-5 h-5" /> Case Details
                    </h2>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                        <label className="block text-sm font-medium text-slate-600 mb-1">Case Number</label>
                        <input 
                            type="text" 
                            name="caseNumber" 
                            value={caseData.caseNumber}
                            onChange={handleInputChange}
                            className="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-indigo-500 outline-none print:border-none print:p-0 print:font-mono print:text-lg"
                            placeholder="e.g. 2023-CR-8842"
                        />
                        </div>
                        <div>
                        <label className="block text-sm font-medium text-slate-600 mb-1">Prosecution</label>
                        <input 
                            type="text" 
                            name="prosecutionName" 
                            value={caseData.prosecutionName}
                            onChange={handleInputChange}
                            className="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-indigo-500 outline-none print:border-none print:p-0 print:font-bold"
                            placeholder="e.g. R (Crown)"
                        />
                        </div>
                        <div>
                        <label className="block text-sm font-medium text-slate-600 mb-1">Defendant</label>
                        <input 
                            type="text" 
                            name="defendantName" 
                            value={caseData.defendantName}
                            onChange={handleInputChange}
                            className="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-indigo-500 outline-none print:border-none print:p-0 print:font-bold"
                            placeholder="e.g. John Doe"
                        />
                        </div>
                    </div>
                    </section>

                    {/* Statements */}
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <section className="bg-white p-6 rounded-lg shadow-sm border border-slate-200 print:shadow-none print:border-0 print:border-b">
                        <h3 className="font-semibold text-slate-700 mb-3 flex items-center gap-2">
                        <User className="w-4 h-4 text-blue-600" /> Prosecution Statement
                        </h3>
                        <textarea 
                        name="prosecutionStatement" 
                        value={caseData.prosecutionStatement}
                        onChange={handleInputChange}
                        className="w-full h-48 p-3 border border-slate-300 rounded focus:ring-2 focus:ring-indigo-500 outline-none text-sm leading-relaxed resize-none print:border-none print:p-0 print:text-xs print:h-auto"
                        placeholder="Enter the prosecution's summary of facts and charges..."
                        ></textarea>
                    </section>

                    <section className="bg-white p-6 rounded-lg shadow-sm border border-slate-200 print:shadow-none print:border-0 print:border-b">
                        <h3 className="font-semibold text-slate-700 mb-3 flex items-center gap-2">
                        <User className="w-4 h-4 text-amber-600" /> Defendant Statement
                        </h3>
                        <textarea 
                        name="defendantStatement" 
                        value={caseData.defendantStatement}
                        onChange={handleInputChange}
                        className="w-full h-48 p-3 border border-slate-300 rounded focus:ring-2 focus:ring-indigo-500 outline-none text-sm leading-relaxed resize-none print:border-none print:p-0 print:text-xs print:h-auto"
                        placeholder="Enter the defendant's plea and mitigating circumstances..."
                        ></textarea>
                    </section>
                    </div>

                    {/* Action Bar */}
                    <div className="flex justify-center print:hidden no-print">
                    <button 
                        onClick={analyzeCase} 
                        disabled={loading}
                        className={`
                        flex items-center gap-3 px-8 py-3 rounded-full text-white font-medium shadow-lg hover:shadow-xl transition-all
                        ${loading ? 'bg-slate-400 cursor-not-allowed' : 'bg-gradient-to-r from-indigo-600 to-purple-600 hover:scale-105'}
                        `}
                    >
                        {loading ? <Loader2 className="animate-spin" /> : <Book className="w-5 h-5" />}
                        {loading ? 'Analyzing Case Law...' : 'Analyze Evidence'}
                    </button>
                    </div>

                    {error && (
                    <div className="bg-red-50 text-red-700 p-4 rounded-lg flex items-center gap-3 border border-red-200 print:hidden">
                        <AlertCircle className="w-5 h-5" />
                        {error}
                    </div>
                    )}

                    {/* Analysis Results */}
                    {analysis && (
                    <div className="space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500">
                        
                        {/* Facts & Recommendation Grid */}
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        
                        {/* Pertinent Facts */}
                        <div className="lg:col-span-2 bg-white p-6 rounded-lg shadow-sm border border-slate-200 print:border-none print:shadow-none">
                            <h3 className="text-lg font-semibold mb-4 text-slate-800">Pertinent Facts Identified</h3>
                            <ul className="space-y-2">
                            {analysis.facts.map((fact, idx) => (
                                <li key={idx} className="flex items-start gap-2 text-sm text-slate-700">
                                <span className="mt-1.5 w-1.5 h-1.5 bg-indigo-500 rounded-full flex-shrink-0" />
                                {fact}
                                </li>
                            ))}
                            </ul>
                        </div>

                        {/* Recommendation Card */}
                        <div className={`
                            p-6 rounded-lg border-2 shadow-sm flex flex-col justify-between print:border print:border-slate-300
                            ${getConfidenceColor(analysis.confidence)}
                        `}>
                            <div>
                            <h3 className="font-bold flex items-center gap-2 mb-2">
                                <Scale className="w-5 h-5" />
                                Sentencing Recommendation
                            </h3>
                            <p className="text-sm font-medium opacity-90 mb-4">{analysis.recommendation}</p>
                            <p className="text-xs opacity-75 italic">{analysis.reasoning}</p>
                            </div>
                            <div className="mt-4 pt-4 border-t border-current border-opacity-20 flex justify-between items-end">
                            <span className="text-xs font-bold uppercase tracking-wider">AI Confidence</span>
                            <span className="text-2xl font-bold">{analysis.confidence}%</span>
                            </div>
                        </div>
                        </div>

                        {/* Case Law Table */}
                        <div className="bg-white p-6 rounded-lg shadow-sm border border-slate-200 print:shadow-none print:border-none">
                        <h3 className="text-lg font-semibold mb-4 text-slate-800 flex justify-between items-center">
                            <span>Applicable Case Law</span>
                            <span className="text-xs font-normal text-slate-500 bg-slate-100 px-2 py-1 rounded print:hidden no-print">
                            Toggle checkbox to mark as relevant
                            </span>
                        </h3>
                        <div className="overflow-x-auto">
                            <table className="w-full text-sm text-left">
                            <thead className="bg-slate-50 text-slate-600 print:bg-transparent print:border-b-2 print:border-black">
                                <tr>
                                <th className="p-3 w-10 text-center print:hidden no-print">#</th>
                                <th className="p-3">Citation</th>
                                <th className="p-3">Legal Principle Summary</th>
                                </tr>
                            </thead>
                            <tbody className="divide-y divide-slate-100 print:divide-slate-300">
                                {analysis.caseLaw.map((law, idx) => (
                                <tr 
                                    key={idx} 
                                    className={`
                                    transition-colors cursor-pointer print:cursor-default
                                    ${!law.relevant ? 'opacity-40 bg-slate-50 print:hidden' : 'hover:bg-indigo-50'}
                                    `}
                                    onClick={() => toggleCaseLawRelevance(idx)}
                                >
                                    <td className="p-3 text-center print:hidden no-print">
                                    <input 
                                        type="checkbox" 
                                        checked={law.relevant} 
                                        onChange={() => {}} // Handled by row click
                                        className="rounded text-indigo-600 focus:ring-indigo-500"
                                    />
                                    </td>
                                    <td className="p-3 font-mono font-medium text-indigo-700 print:text-black">
                                    {law.citation}
                                    </td>
                                    <td className="p-3 text-slate-600 print:text-black">
                                    {law.summary}
                                    </td>
                                </tr>
                                ))}
                            </tbody>
                            </table>
                        </div>
                        </div>
                    </div>
                    )}

                    {/* Final Judgment Section */}
                    <section className="bg-white p-8 rounded-lg shadow-md border-t-4 border-indigo-600 print:shadow-none print:border-t-2 print:border-black print:mt-8 break-inside-avoid">
                    <h2 className="text-2xl font-bold mb-6 text-slate-800 flex items-center gap-3">
                        <Gavel className="w-6 h-6" /> Final Judgment
                    </h2>

                    <div className="space-y-6">
                        <div>
                        <label className="block text-sm font-bold text-slate-700 mb-2 uppercase tracking-wide">Applied Sentence</label>
                        <input 
                            type="text"
                            name="finalSentence"
                            value={judgment.finalSentence}
                            onChange={(e) => handleInputChange(e, 'judgment')}
                            className="w-full p-4 text-lg border-2 border-slate-200 rounded-lg focus:border-indigo-500 outline-none transition-colors print:border-none print:p-0 print:border-b print:border-black print:rounded-none"
                            placeholder="Enter the final sentence to be recorded..."
                        />
                        </div>

                        <div>
                        <label className="block text-sm font-bold text-slate-700 mb-2 uppercase tracking-wide">Judicial Notes</label>
                        <textarea
                            name="judgeNotes"
                            value={judgment.judgeNotes}
                            onChange={(e) => handleInputChange(e, 'judgment')}
                            className="w-full h-32 p-4 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none resize-none print:border-none print:p-0"
                            placeholder="Enter remarks regarding sentencing deviation, mitigation, or specific orders..."
                        ></textarea>
                        </div>

                        <div className="grid grid-cols-2 gap-8 pt-6 border-t border-slate-100 print:border-transparent">
                        <div>
                            <label className="block text-xs font-bold text-slate-500 mb-1 uppercase">Adjudicator Name</label>
                            <input 
                            type="text"
                            name="judgeName"
                            value={judgment.judgeName}
                            onChange={(e) => handleInputChange(e, 'judgment')}
                            className="w-full p-2 bg-slate-50 border-b-2 border-slate-300 focus:border-indigo-500 outline-none print:bg-white print:border-black"
                            placeholder="Hon. Name"
                            />
                        </div>
                        <div>
                            <label className="block text-xs font-bold text-slate-500 mb-1 uppercase">Date</label>
                            <input 
                            type="date"
                            name="date"
                            value={judgment.date}
                            onChange={(e) => handleInputChange(e, 'judgment')}
                            className="w-full p-2 bg-slate-50 border-b-2 border-slate-300 focus:border-indigo-500 outline-none print:bg-white print:border-black"
                            />
                        </div>
                        </div>
                        
                        <div className="hidden print:block mt-16 pt-8 border-t border-black w-1/2">
                        <p className="text-sm font-serif">Signature of Presiding Judge/Magistrate</p>
                        </div>
                    </div>
                    </section>

                </main>

                <footer className="max-w-5xl mx-auto p-6 text-center text-slate-400 text-sm print:hidden no-print">
                    <p>Disclaimer: This tool utilizes AI for research assistance only. All case law citations should be verified independently. Sentencing recommendations are non-binding suggestions.</p>
                </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>

    <script>
        // Register service worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./judge-sw.js')
                    .then((registration) => {
                        console.log('ServiceWorker registration successful:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
    </script>
</body>
