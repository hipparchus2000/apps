<!DOCTYPE html>
<html>
<head>
<title>Platform Adventure</title>
<style>
  body { margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; background: #222; font-family: Arial; }
  canvas { border: 3px solid #444; }
  #info { position: absolute; top: 20px; color: white; font-size: 24px; }
</style>
</head>
<body>
<div id="info">Coins: <span id="coins">0</span> | Reach the GOLD PORTAL!</div>
<canvas id="game" width="800" height="400"></canvas>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const coinText = document.getElementById('coins');

// Game state
let keys = {};
let coins = 0;
let gameWon = false;

// Player
const player = {
  x: 50, y: 200, width: 30, height: 30,
  velX: 0, velY: 0,
  speed: 5, jumpPower: 12,
  grounded: false, color: '#4CAF50'
};

// Platforms
const platforms = [
  {x: 0, y: 350, width: 200, height: 50},
  {x: 250, y: 300, width: 150, height: 20},
  {x: 450, y: 250, width: 100, height: 20},
  {x: 600, y: 200, width: 150, height: 20},
  {x: 350, y: 150, width: 100, height: 20},
  {x: 0, y: 100, width: 150, height: 20},
  {x: 700, y: 350, width: 100, height: 50}
];

// Coins
const coinArray = [
  {x: 300, y: 260, width: 20, height: 20, collected: false},
  {x: 480, y: 210, width: 20, height: 20, collected: false},
  {x: 650, y: 160, width: 20, height: 20, collected: false},
  {x: 50, y: 60, width: 20, height: 20, collected: false},
  {x: 400, y: 110, width: 20, height: 20, collected: false}
];

// Goal
const goal = {x: 720, y: 300, width: 40, height: 50};

// Input handling
document.addEventListener('keydown', (e) => keys[e.key] = true);
document.addEventListener('keyup', (e) => keys[e.key] = false);

// Collision detection
function checkCollision(rect1, rect2) {
  return rect1.x < rect2.x + rect2.width &&
         rect1.x + rect1.width > rect2.x &&
         rect1.y < rect2.y + rect2.height &&
         rect1.y + rect1.height > rect2.y;
}

// Game loop
function gameLoop() {
  if (gameWon) return;
  
  // Clear canvas
  ctx.fillStyle = '#87CEEB';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  
  // Player movement
  if (keys['ArrowLeft']) player.velX = -player.speed;
  else if (keys['ArrowRight']) player.velX = player.speed;
  else player.velX *= 0.8; // Friction
  
  if (keys[' '] && player.grounded) {
    player.velY = -player.jumpPower;
  }
  
  // Gravity
  player.velY += 0.5;
  
  // Update position
  player.x += player.velX;
  player.y += player.velY;
  
  // Collision with platforms
  player.grounded = false;
  platforms.forEach(p => {
    if (checkCollision(player, p)) {
      // Landing on top
      if (player.velY > 0 && player.y < p.y) {
        player.y = p.y - player.height;
        player.velY = 0;
        player.grounded = true;
      }
      // Hitting from below
      else if (player.velY < 0 && player.y > p.y) {
        player.y = p.y + p.height;
        player.velY = 0;
      }
      // Side collisions
      else if (player.velX > 0 && player.x < p.x) {
        player.x = p.x - player.width;
      } else if (player.velX < 0 && player.x > p.x) {
        player.x = p.x + p.width;
      }
    }
  });
  
  // Keep player in bounds
  if (player.x < 0) player.x = 0;
  if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;
  if (player.y > canvas.height) {
    player.x = 50; player.y = 200; // Respawn
  }
  
  // Draw platforms
  ctx.fillStyle = '#8B4513';
  platforms.forEach(p => ctx.fillRect(p.x, p.y, p.width, p.height));
  
  // Draw coins
  coinArray.forEach(coin => {
    if (!coin.collected) {
      // Rotating animation
      const time = Date.now() / 200;
      ctx.save();
      ctx.translate(coin.x + coin.width/2, coin.y + coin.height/2);
      ctx.rotate(time);
      ctx.fillStyle = '#FFD700';
      ctx.fillRect(-coin.width/2, -coin.height/2, coin.width, coin.height);
      ctx.restore();
      
      // Collect coin
      if (checkCollision(player, coin)) {
        coin.collected = true;
        coins++;
        coinText.textContent = coins;
      }
    }
  });
  
  // Draw goal (golden portal)
  if (!gameWon) {
    const pulse = Math.sin(Date.now() / 200) * 5;
    ctx.fillStyle = '#FFD700';
    ctx.fillRect(goal.x - pulse/2, goal.y - pulse/2, goal.width + pulse, goal.height + pulse);
    ctx.fillStyle = '#FFA500';
    ctx.font = '20px Arial';
    ctx.fillText('GOAL', goal.x + 2, goal.y + 30);
  }
  
  // Check win condition
  if (checkCollision(player, goal)) {
    gameWon = true;
    ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = '#FFD700';
    ctx.font = 'bold 48px Arial';
    ctx.fillText('YOU WIN!', 260, 200);
    ctx.font = '24px Arial';
    ctx.fillText(`Coins: ${coins}/5`, 320, 250);
  }
  
  // Draw player (simple character)
  ctx.fillStyle = player.color;
  ctx.fillRect(player.x, player.y, player.width, player.height);
  // Eyes
  ctx.fillStyle = 'white';
  ctx.fillRect(player.x + 5, player.y + 6, 6, 6);
  ctx.fillRect(player.x + 19, player.y + 6, 6, 6);
  ctx.fillStyle = 'black';
  ctx.fillRect(player.x + 7, player.y + 8, 2, 2);
  ctx.fillRect(player.x + 21, player.y + 8, 2, 2);
  
  requestAnimationFrame(gameLoop);
}

// Start game
gameLoop();
</script>
</body>
</html>